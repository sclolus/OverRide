Just a %n printf format exploit with modification of the GOT entry for exit.